<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>版本号提取</title>
	</head>
	<body>
		
		
		
		<script>
			
			function getVersion(filedir) {
				var version = 0;
				if(filedir == "" || filedir == null){
					alert("文件名不能为空");
					return ;
				}
				console.log(filedir);
				var extname = filedir.substr(filedir.lastIndexOf('.'));

				
				console.log("文件后缀名为:" + extname);
				console.log(extname.toLowerCase());
				if(extname.toLowerCase() != '.bin') {
					alert('程序文件格式不对，需要的是.bin文件,但是传入的是'+ extname + "文件");
					return;
				}
				var filename = "";
					filename = filedir.substr(filedir.lastIndexOf('/') + 1);
				console.log("文件名为:" + filename);
				var filenameExp = /\/((\w+)\.([LMR])\.(.(\d+))\.(\w+)).[Bb][Ii][Nn]$/g;
				var flag = filenameExp.test(filedir);
				console.log(flag);
				if(flag) {
					console.log("匹配成功");
					filedir.replace(filenameExp, function($1,$2,$3,$4,$5,$6,$7) {
//						console.log("$1为:"+$1,"$2为:"+$2,"$3为:"+$3,"$4为:"+$4, "$5为:"+$5,"$6为："+$6,"$7为："+$7);
//						console.log("$1为:"+$1);
//						console.log("$2为:"+$2);
//						console.log("$3为:"+$3);
//						console.log("$4为:"+$4);
//						console.log("$5为:"+$5); //V201
//						console.log("$6为:"+$6); //201
//						console.log("$7为:"+$7);
						version = $6;
					})
				} else {
					console.log("匹配失败");
					alert("程序文件格式不对,正确的格式如: MA4xxx.L.V201.R.bin, 其中L可以是L或M或R, 但传入的是:"+filename);
				}
				version = parseInt(version);
				return version;
			}
			
//			console.log(getVersion("\aa\bb/a/b/c/MA4xxx.L.V201.R.bin"));
			
			/*
			var programName = "\aa\bb/a/b/c/MA4xxx.L.V201.R.bin";
			console.log(programName);
			console.log(programName.match(/.mcu$/));
			programName.replace(/\/((\w+)\.(\w+)\.(.(\d+))\.(\w+)).bin$/, function($1,$2,$3,$4,$5,$6,$7) {
//				console.log("$1为:"+$1,"$2为:"+$2,"$3为:"+$3,"$4为:"+$4, "$5为:"+$5,"$6为："+$6);
				console.log("$1为:"+$1);
				console.log("$2为:"+$2);
				console.log("$3为:"+$3);
				console.log("$4为:"+$4);
				console.log("$5为:"+$5);
				console.log("$6为:"+$6);
				console.log("$7为:"+$7);
			});
			
			console.log(typeof parseInt("33")); // number
			console.log(typeof parseInt(33));  // number
			*/
			
			/*
			function checkProgramFilename(filedir){
				var filenameExp = /\/((\w+)\.([LMR])\.(.(\d+))\.(.+)).[Bb][Ii][Nn]$/g;
				return filenameExp.test(filedir);
			}
			console.log(checkProgramFilename("\aa\bb/a/b/c/MA4xxx.R.V201.R.bin"));
			*/
			
			var filedir = "\aa\bb/a/b/c/MA4xxx.L.V201.R.bin";
			console.log(filedir);
			console.log(filedir.lastIndexOf('/'));
			console.log(filedir.substr(filedir.lastIndexOf('/') + 1));
		</script>
	</body>
</html>
